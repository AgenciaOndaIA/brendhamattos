{
  "createdAt": "2025-06-06T18:06:46.753Z",
  "updatedAt": "2025-06-07T11:49:06.659Z",
  "id": "iY22fbZXdI1QZSnQ",
  "name": "My workflow 2",
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "path": "hotmart_perpetuo_ervas",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -3860,
        -1060
      ],
      "id": "2f192318-c392-4793-903a-b499a8b837a3",
      "name": "Webhook",
      "webhookId": "f4dda7e1-4472-40ce-a15f-2a3e55c3bda4"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "84924182-8e05-4bc6-b8b6-3863c1be0f06",
              "name": "User Input",
              "value": "={{ $json['TÃ­tulo do VÃ­deo'] }}",
              "type": "string"
            },
            {
              "id": "02602696-d3ad-4aeb-9d18-e80c6cf2ec17",
              "name": "Script Duration",
              "value": "={{ $json.DuraÃ§Ã£o }}",
              "type": "string"
            },
            {
              "id": "c1d43d39-97de-45fa-bbe4-6b993378191b",
              "name": "Status",
              "value": 2980,
              "type": "number"
            },
            {
              "id": "5fe2b8ea-aa8c-4edb-b3bb-9df2f445662c",
              "name": "Provedor Imagens",
              "value": "={{ $json['Provedor Imagens'] }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3560,
        -1240
      ],
      "id": "b2b98fc2-319d-404c-a819-8c53152a3dde",
      "name": "Set Idea"
    },
    {
      "parameters": {
        "content": "## Criar TÃ­tulo, DescriÃ§Ã£o e Script",
        "height": 580,
        "width": 2080,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -3620,
        -1400
      ],
      "id": "b7dd3ae7-a337-4c80-a113-830302179df6",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "formTitle": "Sistema Criador De VÃ­deos Curtos 1.0",
        "formDescription": "Criador de vÃ­deos narrados e legendados.",
        "formFields": {
          "values": [
            {
              "fieldLabel": "TÃ­tulo do VÃ­deo",
              "fieldType": "textarea",
              "placeholder": "Digite um tÃ­tulo para o vÃ­deo",
              "requiredField": true
            },
            {
              "fieldLabel": "DuraÃ§Ã£o",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "15 segundos"
                  },
                  {
                    "option": "30 segundos"
                  },
                  {
                    "option": "60 segundos"
                  },
                  {
                    "option": "120 segundos"
                  }
                ]
              }
            },
            {
              "fieldLabel": "Estilo Generativo",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "3D Render"
                  },
                  {
                    "option": "Anime"
                  },
                  {
                    "option": "Cartoon flat, bold outline"
                  },
                  {
                    "option": "Cel-shaded anime light"
                  },
                  {
                    "option": "Disney Pixar"
                  },
                  {
                    "option": "Hand-Drawn"
                  },
                  {
                    "option": "Stick Figure, 2D"
                  },
                  {
                    "option": "Hyper-Realistic"
                  },
                  {
                    "option": "Minimalist vector"
                  },
                  {
                    "option": "Pixel-art chibi (16-bit)"
                  }
                ]
              }
            },
            {
              "fieldLabel": "Tipo de VÃ­deo",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "Ideia do UsuÃ¡rio"
                  },
                  {
                    "option": "TranscriÃ§Ã£o"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "TTS Voz",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "af_bella"
                  },
                  {
                    "option": "af_heart"
                  },
                  {
                    "option": "bm_v0george"
                  },
                  {
                    "option": "ef_dora"
                  },
                  {
                    "option": "em_alex"
                  },
                  {
                    "option": "em_santa"
                  },
                  {
                    "option": "jf_gongitsune"
                  },
                  {
                    "option": "pf_dora"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "Provedor Imagens",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "togetherai"
                  }
                ]
              },
              "requiredField": true
            }
          ]
        },
        "options": {
          "appendAttribution": false,
          "ignoreBots": true
        }
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.2,
      "position": [
        -3820,
        -1240
      ],
      "id": "52800da9-410e-4742-b234-2c1e079a5180",
      "name": "On form submission",
      "webhookId": "86f080b2-e18b-4573-aed3-2118fc727f4d"
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"Title\": {\n      \"type\": \"string\",\n      \"description\": \"TÃ­tulo curto e envolvente, motivado pela curiosidade.\"\n},\n  \"Description\": {\n    \"type\": \"string\",\n    \"description\": \"DescriÃ§Ã£o curta com hashtags principais, gancho, contexto, CTA e hashtags.\"\n},\n  \"Hook\": {\n    \"type\": \"string\",\n    \"description\": \"IntroduÃ§Ã£o.\"\n},\n  \"MainScript\": {\n    \"type\": \"string\",\n    \"description\": \"ConteÃºdo do roteiro principal.\"\n},\n  \"CTA\": {\n    \"type\": \"string\",\n    \"description\": \"Chamada para aÃ§Ã£o\"\n}\n},\n  \"required\": [\"TÃ­tulo\", \"DescriÃ§Ã£o\", \"IntroduÃ§Ã£o\", \"MainScript\"]\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        -2380,
        -1000
      ],
      "id": "9bc76a81-3672-48cb-bbc0-01076ee9a47e",
      "name": "Structured Output Parser1"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Tema Do VÃ­deo:\n{{ $('Set Idea').item.json['User Input'] }}\n\nDuraÃ§Ã£o Aproximada:\n{{ $('Set Idea').item.json['Script Duration'] }}",
        "messages": {
          "messageValues": [
            {
              "message": "=VocÃª Ã© **ShortVideoCopywriterGPT**, roteirista especializado em vÃ­deos verticais (TikTok, Reels, Shorts).\n\nINPUT (do usuÃ¡rio)  \n1. Tema do vÃ­deo (string)  \n2. DuraÃ§Ã£o aproximada em segundos (D)  \n\nOBJETIVO  \nâ€¢ Criar um roteiro VIRAL, DINÃ‚MICO e ORIGINAL que caiba na duraÃ§Ã£o solicitada.  \nâ€¢ Use a mÃ©trica-guia de 3 PALAVRAS POR SEGUNDO.  \nâ€ƒLimite-alvo = D Ã— 3 palavras (tolerÃ¢ncia Â± 5).  \nâ€¢ Conte as palavras de Hook + MainScript + CTA; se estiver fora do intervalo, ajuste antes de responder.\n\n**Formato de SaÃ­da:**\n- **TÃ­tulo:** [TÃ­tulo cativante e instigante, baseado na ideia do usuÃ¡rio]\n- **DescriÃ§Ã£o:** [Resumo conciso de 50 a 150 caracteres com hashtags relevantes para o tÃ³pico do usuÃ¡rio]\n- **Gancho:** [Uma frase de abertura que chame a atenÃ§Ã£o, inspirada na ideia do usuÃ¡rio]\n- **Script Principal:** [Um roteiro natural, falado, sem quebras de linha ou emojis, adaptado Ã  duraÃ§Ã£o do vÃ­deo definida pelo usuÃ¡rio]\n- **Chamada para AÃ§Ã£o:** [Uma mensagem convincente que incentive os espectadores a se envolverem, como \"Qual foi a sua parte favorita desta histÃ³ria?\" ou \"Quer explorar mais ideias? Siga para saber mais!\"]\n\nREGRAS OBRIGATÃ“RIAS  \n1. NÃ£o adicione quebras de linha nem emojis em Hook, MainScript ou CTA.  \n2. Evite termos NSFW, marcas registradas ou menÃ§Ãµes a pessoas reais.  \n3. Use linguagem simples, frases curtas e um dado surpresa nos primeiros 2 segundos.  \n4. Pense em imagens simples que o Flux Shell renderiza bem (cartoon/flat, cores vivas), mas **nÃ£o** inclua referÃªncias visuais no JSON.  \n5. Devolva **apenas** o JSON no formato acima.  \n6. Hooks devem ser variados, evite repetir estrutura em roteiros consecutivos.  \n7. MainScript: VocÃª nÃ£o deve fazer promessas de tempo de execuÃ§Ã£o (por ex. â€˜em 30 minutosâ€™) a menos que haja evidÃªncia concreta.  \n8. NÃ£o use aspas duplas (\") no conteÃºdo do campo \"Script Principal\". Use aspas simples (') se for necessÃ¡rio indicar uma citaÃ§Ã£o ou destaque textual. Isso garante que a saÃ­da seja um JSON limpo e compatÃ­vel com sistemas de automaÃ§Ã£o como n8n."
            }
          ]
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.5,
      "position": [
        -2940,
        -1140
      ],
      "id": "ce9a81a4-736e-41e9-aa06-49405cf5dfa4",
      "name": "Script Writier ðŸ§ "
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=User Input: {{ $json.text }}",
        "hasOutputParser": true,
        "messages": {
          "messageValues": [
            {
              "message": "=Considere a entrada e a saÃ­da do usuÃ¡rio na seguinte estrutura JSON. NÃƒO altere ou altere nenhum texto.\n\n{\n\"type\": \"object\",\n\"properties\": {\n\"Title\": {\n\"type\": \"string\",\n\"description\": \"TÃ­tulo curto e envolvente, motivado pela curiosidade.\"\n},\n\"Description\": {\n\"type\": \"string\",\n\"description\": \"DescriÃ§Ã£o curta com hashtags principais, gancho, contexto, CTA e hashtags.\"\n},\n\"Hook\": {\n\"type\": \"string\",\n\"description\": \"O gancho.\"\n},\n\"MainScript\": {\n\"type\": \"string\",\n\"description\": \"ConteÃºdo do script principal.\"\n},\n\"CTA\": {\n\"type\": \"string\",\n\"description\": \"Chamada para aÃ§Ã£o\"\n}\n},\n\"required\": [\"TÃ­tulo\", \"DescriÃ§Ã£o\", \"IntroduÃ§Ã£o\", \"Script Principal\"]\n}"
            }
          ]
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.5,
      "position": [
        -2540,
        -1240
      ],
      "id": "fc12bbbb-a323-462f-926c-09d7c35cf947",
      "name": "Output Parser ðŸ› "
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('On form submission').item.json['Video Type'] }}",
                    "rightValue": "From transcript",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "67835e1a-7770-4d3e-b9d6-0dac59a5923a"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "From transcript"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "171a9dfd-59a3-49a4-af28-c284abc85f13",
                    "leftValue": "",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "User Idea"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -3180,
        -1240
      ],
      "id": "f2e7d397-e252-4c19-9620-3717c17b2c82",
      "name": "Switch"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=A TranscriÃ§Ã£o:\n{{ $json['User Input'] }}",
        "messages": {
          "messageValues": [
            {
              "message": "=Atuar como um roteirista de vÃ­deos do YouTube especializado em transformar insights, fatos interessantes e principais conclusÃµes em roteiros de vÃ­deo envolventes e concisos. Seu objetivo Ã© criar roteiros curtos e atraentes com base nas ideias mais intrigantes de transcriÃ§Ãµes longas de podcasts, apresentando-os como conteÃºdo original e atual, sem referenciar fontes ou nomes.\n\nSeu roteiro deve ser envolvente, dinÃ¢mico e fÃ¡cil de acompanhar, transformando ideias complexas em narrativas empolgantes e de fÃ¡cil assimilaÃ§Ã£o. Use um tom coloquial, descriÃ§Ãµes vÃ­vidas e um gancho forte para prender a atenÃ§Ã£o instantaneamente. Mantenha o ritmo Ã¡gil, garantindo que cada segundo conte.\n\nDiretrizes importantes:\n- NÃƒO use asteriscos (*) ou emojis. Mantenha o texto limpo e formatado naturalmente.\n- NÃƒO inclua quebras de linha no \"MainScript\", a menos que seja necessÃ¡rio para facilitar a leitura. Escreva em um estilo natural e falado, como se estivesse sendo narrado por uma pessoa.\n- O roteiro deve ser ORIGINAL e coloquial, sem referÃªncias diretas a podcasts, apresentadores ou episÃ³dios especÃ­ficos. - O Call to Action deve ser simples e envolvente. Exemplos: \"Qual foi o seu insight favorito?\" ou \"Quer mais ideias como esta? Siga para mais!\"\n\nFormato de SaÃ­da:\n- TÃ­tulo: [TÃ­tulo cativante e instigante]\n- DescriÃ§Ã£o: [50-150 caracteres, resumo conciso com hashtags importantes]\n- Gancho: [Uma frase de abertura que chame a atenÃ§Ã£o]\n- MainScript: [Um roteiro natural e falado â€” SEM asteriscos, SEM emojis, SEM formataÃ§Ã£o desnecessÃ¡ria]\n- Call to Action: [Um prompt atraente que incentive os espectadores a se envolverem]\n\nGaranta que o MainScript seja fluido e envolvente, como se esses insights estivessem sendo compartilhados em primeira mÃ£o. Mantenha tudo contundente e direto, garantindo alta retenÃ§Ã£o e engajamento."
            }
          ]
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.5,
      "position": [
        -2940,
        -1300
      ],
      "id": "8537eb67-0ed4-4743-afc5-a3a61a4c3b5c",
      "name": "Long form to Script Writier ðŸ§ "
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "7cd1dc03-8331-44ba-bda9-848145bab939",
              "name": "Main Script",
              "value": "={{ $json.output.Hook }} {{ $json.output.MainScript }} {{ $json.output.CTA }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2200,
        -1240
      ],
      "id": "2bec93ec-20e0-4844-bca7-f764fc1be72a",
      "name": "Combine"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "bfd6c0e6-93c2-496a-8f3d-9ebc3061e78f",
              "name": "Script",
              "value": "={{$json['Main Script']\n  .replace(/\\n{2,}/g, \"\")      // Remove multiple newlines\n  .replace(/\\*(.*?)\\*/g, \"$1\") // Remove asterisks around words\n}}\n",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1980,
        -1240
      ],
      "id": "0844ef47-e474-4ee6-a9d8-b06b3f7377cc",
      "name": "Format Cleanup"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://host.docker.internal:85/api/user-files/upload-file/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            }
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "parameterType": "formBinaryData",
              "name": "file",
              "inputDataFieldName": "captionsFile"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        280,
        -1240
      ],
      "id": "0610e1c9-5b61-4e39-b546-e93972f0340a",
      "name": "Upload captions To Baserow"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://host.docker.internal:85/api/user-files/upload-file/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            }
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "parameterType": "formBinaryData",
              "name": "file",
              "inputDataFieldName": "data"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -660,
        -1020
      ],
      "id": "677caa76-665a-454a-a272-8a6a64a580a9",
      "name": "Upload tts to baserow"
    },
    {
      "parameters": {
        "content": "## Gerar NarraÃ§Ã£o & Legenda\n",
        "height": 580,
        "width": 2280,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1520,
        -1400
      ],
      "id": "c8fb3fde-393a-4b28-9948-0754c5518e72",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://host.docker.internal:8880/v1/audio/speech/",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"kokoro\",\n  \"input\": \"{{ $json.Script }}\",\n  \"voice\": \"{{ $json['TTS Voz'] }}\",\n  \"response_format\": \"mp3\",\n  \"download_format\": \"mp3\",\n  \"speed\": 1,\n  \"lang_code\": \"p\"\n}",
        "options": {
          "response": {
            "response": {
              "fullResponse": true
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -940,
        -1240
      ],
      "id": "c68d9823-0627-4c6d-91f1-e3de67db02d5",
      "name": "Generate TTS"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.groq.com/openai/v1/audio/transcriptions",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "bearer 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"
            }
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "model",
              "value": "whisper-large-v3-turbo"
            },
            {
              "name": "temperature",
              "value": "0"
            },
            {
              "name": "response_format",
              "value": "verbose_json"
            },
            {
              "name": "language",
              "value": "pt"
            },
            {
              "parameterType": "formBinaryData",
              "name": "file",
              "inputDataFieldName": "data"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -660,
        -1240
      ],
      "id": "9037b9d0-8915-465a-a085-3b7322b06021",
      "name": "Criar Legenda"
    },
    {
      "parameters": {
        "jsCode": "// 1) ParÃ¢metros de controle\nconst MAX_CHARS = 40;   // mÃ¡ximo de caracteres por legenda\nconst segments = items[0].json.segments || [];\n\n// 2) Transforma o texto e timestamps em legendas â€œcortadasâ€\nconst captions = [];\n\nfor (const seg of segments) {\n  const words = seg.text.trim().split(\" \");\n  let line = \"\";\n  let startTime = null;\n\n  for (const w of words) {\n    // Se ainda nÃ£o iniciou a linha, define startTime\n    if (line === \"\") {\n      startTime = seg.start + seg.text.indexOf(w) / seg.text.length * (seg.end - seg.start);\n      // (este cÃ¡lculo Ã© sÃ³ aproximado; para precisÃ£o palavra-a-palavra vocÃª precisaria dos timepoints)\n    }\n    // Se adicionar esta palavra ultrapassa o limite de chars, fecha a linha atual\n    if ((line + \" \" + w).trim().length > MAX_CHARS) {\n      captions.push({ word: line.trim(), start_time: startTime, end_time: seg.start + (seg.text.indexOf(w) / seg.text.length) * (seg.end - seg.start) });\n      line = w;\n      startTime = seg.start + seg.text.indexOf(w) / seg.text.length * (seg.end - seg.start);\n    } else {\n      line = (line + \" \" + w).trim();\n    }\n  }\n  // Fecha a Ãºltima linha do segmento\n  if (line) {\n    captions.push({ word: line, start_time: startTime, end_time: seg.end });\n  }\n}\n\n// 3) Embaralha de volta num formato de itens para o prÃ³ximo nÃ³\nreturn captions.map(c => ({ json: c }));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -400,
        -1240
      ],
      "id": "dbae3ad1-3f38-4578-bf7e-5d05808a108f",
      "name": "Frases Curtas"
    },
    {
      "parameters": {
        "jsCode": "// 1) Pega o ID do node anterior (mesmo se estiver pinado)\nconst originalId = $('Buscar tabelas 1').all()[0].json.id;\n\n// 2) ConstrÃ³i o array de legendas\nconst captionsArray = items.map(i => ({\n  text: i.json.text,\n  start_time: i.json.start,\n  end_time: i.json.end,\n}));\n\n// 3) Serializa e converte para buffer\nconst jsonString = JSON.stringify(captionsArray, null, 2);\nconst buffer = Buffer.from(jsonString);\n\n// 4) Retorna com ID + buffer\nreturn [{\n  json: { id: originalId },\n  binary: {\n    captionsFile: {\n      data: buffer,\n      fileName: 'captions.json',\n      mimeType: 'application/json',\n    }\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        40,
        -1240
      ],
      "id": "634a76bc-12a6-4baf-9080-1f00ee231378",
      "name": "Legenda.json"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "include": "specifiedFields",
        "fieldsToInclude": "id",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        100,
        -740
      ],
      "id": "cb17c0a6-9a90-4d19-8837-85452729c054",
      "name": "Aggregate3"
    },
    {
      "parameters": {
        "jsCode": "// Initialize an array to hold IDs\nconst ids = [];\n\n// Loop over input items\nfor (const item of $input.all()) {\n  // Loop through each 'data' array\n  for (const dataItem of item.json.data) {\n    // Check if 'id' is defined\n    if (dataItem.id) {\n      // Push the ID into the array\n      ids.push(dataItem.id);\n    }\n  }\n}\n\n// Return the array wrapped in an object\nreturn [{ json: { ids } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        300,
        -740
      ],
      "id": "2dd0f172-3165-420d-b85d-22003bf849d7",
      "name": "IDs To Array1"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"Prompt\": \"insira o prompt aqui\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        -360,
        -580
      ],
      "id": "d2eb0f66-e191-423b-b50a-c249a9bee802",
      "name": "Structured Output Parser2"
    },
    {
      "parameters": {
        "jsCode": "const splitLength=5;const inputData=$input.first().json.Segments;const segments=[];let currentSegment={id:0,words:\"\",duration:0};let currentStartTime=-1;let totalDuration=0;let currentEndTime=0;const pauseBuffer=0.1;for(const wordObj of inputData){const{text,start_time,end_time}=wordObj;if(currentStartTime===-1){currentStartTime=start_time;}currentSegment.words+=(currentSegment.words?' ':'')+text;currentEndTime=end_time;currentSegment.duration=(currentEndTime-currentStartTime).toFixed(2);if(currentSegment.duration>=splitLength){currentSegment.duration=(parseFloat(currentSegment.duration)+pauseBuffer).toFixed(2);totalDuration+=parseFloat(currentSegment.duration);segments.push(currentSegment);currentSegment={id:segments.length,words:\"\",duration:0};currentStartTime=-1;}}if(currentSegment.words){currentSegment.duration=(currentEndTime-currentStartTime).toFixed(2);currentSegment.duration=(parseFloat(currentSegment.duration)+pauseBuffer).toFixed(2);totalDuration+=parseFloat(currentSegment.duration);segments.push(currentSegment);}const roundedTotalDuration=Math.round(totalDuration);const totalSeconds=Math.floor(roundedTotalDuration);const minutes=Math.floor(totalSeconds/60);const seconds=totalSeconds%60;const totalRuntimeString=`${minutes} minute${minutes!==1?'s':''}, ${seconds} second${seconds!==1?'s':''}`;return segments.map(s=>({json:{...s,totalDuration:roundedTotalDuration,totalRuntimeString}}));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1740,
        -680
      ],
      "id": "3a094c52-ed91-47bd-8480-473f3ab649fe",
      "name": "Split into 5s Scenes"
    },
    {
      "parameters": {
        "url": "={{ $json['URL Legenda'] }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2160,
        -680
      ],
      "id": "82edaefe-a1f7-46cc-bcb5-ed7468bba569",
      "name": "Get Segment File"
    },
    {
      "parameters": {
        "content": "## Gerar Cenas & Prompts das Imagens\n",
        "height": 360,
        "width": 4380,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -3620,
        -800
      ],
      "id": "47c81b2c-bbd2-4ebf-aa3b-643212221644",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "jsCode": "const inputSegments = $input.all();\n\nif (inputSegments.length > 0) {\n  const lastSegment = inputSegments[inputSegments.length - 1].json;\n\n  if (parseFloat(lastSegment.duration) < 2.0 && inputSegments.length > 1) {\n    const secondLastSegment = inputSegments[inputSegments.length - 2].json;\n\n    // Merge palavras\n    secondLastSegment.words += ' ' + lastSegment.words;\n    \n    // Soma das duraÃ§Ãµes\n    secondLastSegment.duration = (\n      parseFloat(secondLastSegment.duration) + parseFloat(lastSegment.duration)\n    ).toFixed(2);\n\n    // Remove o Ãºltimo item\n    inputSegments.pop();\n  }\n}\n\n// Retorna os segmentos corrigidos (como array de items)\nreturn inputSegments;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1520,
        -680
      ],
      "id": "edff7699-37d2-45af-ac88-2b439723cb98",
      "name": "Fixer"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "destinationFieldName": "Segments",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -1960,
        -680
      ],
      "id": "3385e070-369a-4c24-9aea-8a3c92b3d2f0",
      "name": "Aggregate"
    },
    {
      "parameters": {
        "content": "## together.ai - GERAÃ‡ÃƒO DE IMAGENS GRÃTIS",
        "height": 300,
        "width": 1160,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -2740,
        120
      ],
      "id": "7f511e7c-3731-4c9c-9bf4-34658c9766b5",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json[\"Provedor Imagem\"].value }}",
                    "rightValue": "together.ai2",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "eaf1a214-ae9e-455f-889b-5fb2f010b2a6"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "togetherai2"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "3e78a869-ccdb-4d17-b4f0-bc61733f6232",
                    "leftValue": "={{ $json[\"Provedor Imagem\"].value }}",
                    "rightValue": "together.ai",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "togetherai"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -3100,
        180
      ],
      "id": "3e46eaf3-a128-4761-bcb2-37c1836563e7",
      "name": "Switch - Image Provider"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.together.xyz/v1/images/generations",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"model\": \"black-forest-labs/FLUX.1-schnell-Free\",\n    \"prompt\": {{ JSON.stringify($json.Prompt) }},\n    \"width\": 576,\n    \"height\": 1024,\n    \"steps\": 4,\n    \"n\": 1,\n    \"response_format\": \"b64_json\"\n   }",
        "options": {
          "response": {
            "response": {
              "fullResponse": true
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2680,
        200
      ],
      "id": "5ae2a125-9327-4b49-99f5-02c341e8e70e",
      "name": "HTTP - Together.ai"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://host.docker.internal:85/api/user-files/upload-file/",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            }
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "parameterType": "formBinaryData",
              "name": "file",
              "inputDataFieldName": "data"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2120,
        200
      ],
      "id": "201d02e9-4e9b-4a59-8c72-e0ae5916fcd3",
      "name": "HTTP - Upload To Baserow"
    },
    {
      "parameters": {
        "mode": "jsonToBinary",
        "convertAllData": false,
        "sourceKey": "base64Image",
        "options": {
          "dataIsBase64": true,
          "fileName": "image.png",
          "mimeType": "image/png"
        }
      },
      "id": "ff0cff81-3832-44b1-99d6-bcffffb9fb9e",
      "name": "Convert String to binary",
      "type": "n8n-nodes-base.moveBinaryData",
      "typeVersion": 1,
      "position": [
        -2300,
        200
      ]
    },
    {
      "parameters": {
        "fields": {
          "values": [
            {
              "name": "base64Image",
              "stringValue": "={{ $json.body.data[0].b64_json }}"
            }
          ]
        },
        "options": {}
      },
      "id": "e04579e3-868e-404b-b29b-857694d16033",
      "name": "Base64 To String",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.1,
      "position": [
        -2480,
        200
      ]
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -1760,
        200
      ],
      "id": "f3102f37-2fa4-4c10-9496-e7a59b578cae",
      "name": "Wait1",
      "webhookId": "bde535a6-423a-41f8-925f-a44961019398"
    },
    {
      "parameters": {
        "content": "## Gerar Imagens Usando Flux Schnell\n",
        "height": 900,
        "width": 2180,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -3620,
        -420
      ],
      "id": "1fb1d91a-1988-4874-ae05-4eea3ceb4958",
      "name": "Sticky Note11"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -3140,
        -280
      ],
      "id": "736fa938-5c53-4d07-8c1d-fb2215e0bb82",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "fieldToSplitOut": "Cenas",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -780,
        -320
      ],
      "id": "4b0b9026-22eb-40ed-9fd3-91997cc47788",
      "name": "Split Out2",
      "executeOnce": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://host.docker.internal:8080/v1/video/caption",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"video_url\": \"{{ $json['URL VÃ­deo + Audio'] }}\",\n    \"settings\": {\n        \"line_color\": \"#FFFFFF\",\n        \"word_color\": \"#fff700\",\n        \"all_caps\": false,\n        \"max_words_per_line\": 3,\n        \"font_size\": 50,\n        \"bold\": false,\n        \"italic\": false,\n        \"underline\": false,\n        \"strikeout\": false,\n        \"outline_width\": 6,\n        \"shadow_offset\": 8,\n        \"style\": \"highlight\",\n        \"font_family\": \"The Bold Font\",\n        \"position\": \"top_center\"\n    },\n    \"id\": \"{{ $json.id }}\"\n}",
        "options": {
          "timeout": 90000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        260,
        320
      ],
      "id": "fa43034f-da8b-4897-8f9f-64475671efdc",
      "name": "Create Captions"
    },
    {
      "parameters": {
        "fieldToSplitOut": "Cenas",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -960,
        20
      ],
      "id": "3cef2d6d-a196-4cc4-a778-9250620ba926",
      "name": "Split Out1",
      "executeOnce": true
    },
    {
      "parameters": {
        "content": "## Juntar VÃ­deo & NarraÃ§Ã£o",
        "height": 240,
        "width": 960,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1420,
        240
      ],
      "id": "f58429df-b11d-4971-8f74-d348165e33ee",
      "name": "Sticky Note7"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://host.docker.internal:8080/v1/ffmpeg/compose",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"id\": \"audio-layering\",\n    \"inputs\": [\n        {\n            \"file_url\": \"{{ $json.results[0][\"URL VÃ­deo Bruto\"] }}\"\n        },\n        {\n            \"file_url\": \"{{ $json.results[0][\"TTS Audio\"][0].url }}\"\n        }\n    ],\n    \"filters\": [\n        {\n            \"filter\": \"[1:a]volume=1[outa]\"\n        }\n    ],\n    \"outputs\": [\n        {\n            \"options\": [\n                {\n                    \"option\": \"-map\",\n                    \"argument\": \"0:v\"\n                },\n                {\n                    \"option\": \"-map\",\n                    \"argument\": \"[outa]\"\n                },\n                {\n                    \"option\": \"-c:v\",\n                    \"argument\": \"copy\"\n                },\n                {\n                    \"option\": \"-c:a\",\n                    \"argument\": \"aac\"\n                }\n            ]\n        }\n    ]\n}\n",
        "options": {
          "timeout": 50000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1000,
        320
      ],
      "id": "9137b0d4-a7f4-481b-b1cd-08c956d2d03f",
      "name": "Combine Clips3"
    },
    {
      "parameters": {
        "content": "## Adicionar Legenda",
        "height": 240,
        "width": 1200,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -440,
        240
      ],
      "id": "9ee73b66-5f3a-48d5-b434-3bf2ec586c37",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "jsCode": "// Extract the array of URLs\nconst urls = items[0].json[\"URL VÃ­deo Clip\"] || [];\n\n// Map URLs into the required structure\nconst formattedURLs = urls.map(url => ({ \"video_url\": url }));\n\n// Return the transformed data\nreturn [{\n    json: {\n        \"video_urls\": formattedURLs\n    }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        80,
        20
      ],
      "id": "ad737e24-c7b2-4adc-bc75-7fbd989b277e",
      "name": "Video url to array"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -140,
        -320
      ],
      "id": "36d14c44-f821-4b68-bac9-779441883724",
      "name": "Loop Over Items3"
    },
    {
      "parameters": {
        "content": "## Juntar Clipes em 1 Ãšnico VÃ­deo",
        "height": 300,
        "width": 2180,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1420,
        -80
      ],
      "id": "3a4f8d26-e02e-4995-a662-81d62ae5a251",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "content": "## Criar Clipes Para as Imagens\n",
        "height": 320,
        "width": 2180,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1420,
        -420
      ],
      "id": "7b8c7d32-c333-4210-989c-9a31d8244a44",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://host.docker.internal:8080/v1/video/concatenate",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"video_urls\": {{ JSON.stringify($json.video_urls) }},\n    \"id\": \"{{ $('Buscar tabelas 4').item.json.results[0].id }}\"\n}",
        "options": {
          "timeout": 50000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        300,
        20
      ],
      "id": "73379379-5d22-4b6b-a558-7a869f99a8be",
      "name": "Combine Clips"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://host.docker.internal:8080/v1/image/transform/video",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"image_url\":\"{{ $json.results[0].Imagem[0].url }}\",\n    \"length\": {{ $json.results[0][\"DuraÃ§Ã£o\"] }},\n    \"frame_rate\": 25,\n    \"zoom_speed\": 3,\n    \"id\": \"{{ $json.results[0].id }}\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        200,
        -320
      ],
      "id": "90b725f1-b518-4aef-9801-772c69fe1c2e",
      "name": "Create Clips"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "gpt-4o-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -2560,
        -1000
      ],
      "id": "999b9580-d722-43a8-b8fc-cb7a94984869",
      "name": "OpenAI Chat Model"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "gpt-4o-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -660,
        -580
      ],
      "id": "529ca4d6-1bc8-4fc8-92c2-d0f7bd7d7638",
      "name": "OpenAI Chat Model1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://host.docker.internal:85/api/database/rows/table/314/?user_field_names=true",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "DescriÃ§Ã£o",
              "value": "={{ $node['Output Parser ðŸ› '].json.output.Description }}"
            },
            {
              "name": "Script",
              "value": "={{ $json.Script }}"
            },
            {
              "name": "TTS Voz",
              "value": "={{ $node['On form submission'].json['TTS Voz'] }}"
            },
            {
              "name": "Estilo",
              "value": "={{ $node['On form submission'].json['Estilo Generativo'] }}"
            },
            {
              "name": "Prompt Inicial",
              "value": "={{ $node['Set Idea'].json['User Input'] }}"
            },
            {
              "name": "Status",
              "value": "={{ $('Set Idea').item.json.Status }}"
            },
            {
              "name": "Provedor Imagens",
              "value": "={{ $('Provedor Image').item.json.togetherai }}"
            },
            {
              "name": "TÃ­tulo",
              "value": "={{ $node['Output Parser ðŸ› '].json.output.Title }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1740,
        -1240
      ],
      "id": "7ae81810-e11a-478d-ab0d-332c25e4f77f",
      "name": "Criar tabelas baserow 1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "f94ae35a-b4b5-4f44-bb1c-4e929e95d718",
              "name": "={{ $json['Provedor Imagens'] }}",
              "value": "=2982",
              "type": "number"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3380,
        -1240
      ],
      "id": "572ed5d2-3381-4cdf-8385-3ec99e44f086",
      "name": "Provedor Image"
    },
    {
      "parameters": {
        "url": "http://host.docker.internal:85/api/database/rows/table/314/?user_field_names=true&filter__field_6761__contains=Processando",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1400,
        -1240
      ],
      "id": "56ca0151-d2e4-40b3-b95b-14b5f24d509e",
      "name": "Buscar tabelas 1"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=http://host.docker.internal:85/api/database/rows/table/314/{{ $node[\"ID Tabela\"].json.id }}/?user_field_names=true\n\n\n",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "URL Legenda",
              "value": "={{ $json.url }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        540,
        -1240
      ],
      "id": "884bc79c-0145-483d-979c-b1ecbe8a4a41",
      "name": "Atualizar URL Legenda"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "2e9c60a8-b379-45ff-9fed-2d446f0a28fd",
              "name": "id",
              "value": "={{ $json.results[0].id }}",
              "type": "number"
            },
            {
              "id": "af3afe9a-c525-4fcc-b860-a6602fe265de",
              "name": "Script",
              "value": "={{ $json.results[0].Script }}",
              "type": "string"
            },
            {
              "id": "89705751-1791-47e9-aac0-e838feb35b94",
              "name": "TTS Voz",
              "value": "={{ $json.results[0]['TTS Voz'] }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1160,
        -1240
      ],
      "id": "7342ca48-a023-4064-a4e8-ab83a51213d9",
      "name": "ID Tabela"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=http://host.docker.internal:85/api/database/rows/table/314/{{ $node[\"ID Tabela\"].json.id }}/?user_field_names=true\n\n\n",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "TTS Audio",
              "value": "={{ $('Upload tts to baserow').item.json.name }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -400,
        -1020
      ],
      "id": "f64bb22f-3242-4519-bf43-f6e3c273f5fa",
      "name": "Atualizar Tabela TTS"
    },
    {
      "parameters": {
        "url": "http://host.docker.internal:85/api/database/rows/table/314/?user_field_names=true&filter__field_6761__contains=Processando&filter__field_6765__empty=",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -3520,
        -700
      ],
      "id": "576ca1f4-a185-4a96-ab21-fdd11180de56",
      "name": "Buscar tabelas 2"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=http://host.docker.internal:85/api/database/rows/table/314/{{ $json.id }}/?user_field_names=true\n\n\n",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "Status",
              "value": "={{ $json.Status }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2380,
        -680
      ],
      "id": "2f1b604e-53b2-47ba-9e0f-8307418e24d6",
      "name": "Atualizar Status 1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "80b2541c-1803-4751-ace0-08bc1d6141e5",
              "name": "id",
              "value": "={{ $json.results[0].id }}",
              "type": "number"
            },
            {
              "id": "2e9c60a8-b379-45ff-9fed-2d446f0a28fd",
              "name": "URL Legenda",
              "value": "={{ $json.results[0]['URL Legenda'] }}",
              "type": "string"
            },
            {
              "id": "f5b1f0ce-ac06-41a8-967a-a36e9e986214",
              "name": "Status",
              "value": 2986,
              "type": "number"
            },
            {
              "id": "9d4cc0e1-f268-42be-97e8-ae30afad1e74",
              "name": "Script",
              "value": "={{ $json.results[0].Script }}",
              "type": "string"
            },
            {
              "id": "963970ab-e4ae-4870-a6f2-a6b6a2c8e6c9",
              "name": "Estilo",
              "value": "={{ $json.results[0].Estilo }}",
              "type": "string"
            },
            {
              "id": "d37f52a4-70f6-48a4-9c27-f376dd40fa3e",
              "name": "Provedor Imagem",
              "value": "={{ $json.results[0][\"Provedor Imagens\"].value }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3280,
        -700
      ],
      "id": "4b5efd49-4424-4195-9ebd-066d51a9b12a",
      "name": "ID + URL Legenda",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://host.docker.internal:85/api/database/rows/table/710/?user_field_names=true",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "Prompt",
              "value": "={{ $json.output.Prompt }}"
            },
            {
              "name": "DuraÃ§Ã£o",
              "value": "={{ $('Prepare Scene').item.json.duration }}"
            },
            {
              "name": "Provedor Imagem",
              "value": "={{ $('Renomear').item.json[\"object Object\"] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -160,
        -740
      ],
      "id": "2b863eb8-ca20-4b27-b8ab-1f8d993e08c5",
      "name": "Criar tabelas baserow (Cenas)"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=http://host.docker.internal:85/api/database/rows/table/314/{{ $('ID + URL Legenda').item.json.id }}/?user_field_names=true\n\n\n",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "Cenas",
              "value": "={{ $json.ids }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        540,
        -740
      ],
      "id": "70a96667-7059-4c3d-b84a-f0066f0a7c88",
      "name": "Atualizar IDs"
    },
    {
      "parameters": {
        "url": "http://host.docker.internal:85/api/database/rows/table/710/?user_field_names=true&filter__field_6757__empty=",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -3520,
        -280
      ],
      "id": "8c88073d-36df-4b2a-940d-b8b3d408648e",
      "name": "Buscar Cenas"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=http://host.docker.internal:85/api/database/rows/table/710/{{ $('Loop Over Items').item.json.id }}/?user_field_names=true\n\n\n",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "Imagem",
              "value": "={{ $json.name }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1940,
        200
      ],
      "id": "c9250162-74e3-4c9d-8fe7-fd90a663bf61",
      "name": "Atualizar Tabela Imagem"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "7e130a3c-eaea-460c-ba58-f46ea6f14f13",
              "name": "id",
              "value": "={{ $json.id }}",
              "type": "number"
            },
            {
              "id": "60cb5799-8fe6-4cda-98a9-9463ba903ffc",
              "name": "URL Legenda",
              "value": "={{ $json[\"URL Legenda\"] }}",
              "type": "string"
            },
            {
              "id": "1fd92ff1-e06f-492e-ace3-03720d47a2f5",
              "name": "Status",
              "value": "={{ $json.Status }}",
              "type": "number"
            },
            {
              "id": "728f7259-735a-433b-bec8-ca20b6b4200a",
              "name": "Script",
              "value": "={{ $json.Script }}",
              "type": "string"
            },
            {
              "id": "d6ae4773-7923-4abf-856f-18f3aece0c5c",
              "name": "Estilo",
              "value": "={{ $json.Estilo }}",
              "type": "string"
            },
            {
              "id": "4d52ea57-5323-42b6-870d-6af3e18e2934",
              "name": "={{ $json[\"Provedor Imagem\"] }}",
              "value": "=togetherai",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2800,
        -680
      ],
      "id": "112f0c29-7392-4476-ae6c-ddf6f0e36664",
      "name": "ID Provedor Imagem 2"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json[\"Provedor Imagem\"] }}",
                    "rightValue": "falaai",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "eaf1a214-ae9e-455f-889b-5fb2f010b2a6"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "fal.ai"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "3e78a869-ccdb-4d17-b4f0-bc61733f6232",
                    "leftValue": "={{ $json[\"Provedor Imagem\"] }}",
                    "rightValue": "together.ai",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "togetherai"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -3060,
        -700
      ],
      "id": "3f8e3bc1-f09a-4274-ba65-7c2e62f041f0",
      "name": "Switch - Image Provider1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "1904e064-ef81-4c33-9791-dbaaf4f5339b",
              "name": "id",
              "value": "={{ $json.id }}",
              "type": "number"
            },
            {
              "id": "f83d662c-e746-4b3d-a61f-6c0161858073",
              "name": "URL Legenda",
              "value": "={{ $json[\"URL Legenda\"] }}",
              "type": "string"
            },
            {
              "id": "6685a3ab-b267-42d0-9013-760cec61d684",
              "name": "Status",
              "value": "={{ $json.Status }}",
              "type": "number"
            },
            {
              "id": "ef5ef3ec-3630-4435-98c9-303cd0f6be4b",
              "name": "={{ $json.together }}",
              "value": "=2984",
              "type": "number"
            },
            {
              "id": "556e9df7-c0c6-4ced-b844-42682898ca86",
              "name": "Script",
              "value": "={{ $json.Script }}",
              "type": "string"
            },
            {
              "id": "3d47a95e-7c00-4ea3-a5c0-075aeafe8b5d",
              "name": "Estilo",
              "value": "={{ $json.Estilo }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2580,
        -680
      ],
      "id": "0ed7a05d-ed26-40ec-9a9d-327a96ac0646",
      "name": "Renomear"
    },
    {
      "parameters": {
        "fieldToSplitOut": "results",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -3340,
        -280
      ],
      "id": "03692904-0d23-4760-a37c-709993fa105b",
      "name": "Split Out3"
    },
    {
      "parameters": {
        "url": "http://host.docker.internal:85/api/database/rows/table/314/?user_field_names=true&filter__field_6761__contains=Prompt&filter__field_6749__empty=",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1340,
        -320
      ],
      "id": "b665de1e-2dee-4b85-8722-acde86fe05da",
      "name": "Buscar tabelas 3"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=http://host.docker.internal:85/api/database/rows/table/314/{{ $json.results[0].id }}/?user_field_names=true\n\n\n",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "Status",
              "value": "Clipes"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1060,
        -320
      ],
      "id": "e12c2218-31ed-4bd5-8aa8-39dd0e54570b",
      "name": "Atualizar Status 2"
    },
    {
      "parameters": {
        "url": "=http://host.docker.internal:85/api/database/rows/table/710/?user_field_names=true&filter__Record%20ID__equal={{ $json.id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -480,
        -320
      ],
      "id": "0f384ed5-aab0-47a9-9761-bbc2a99f1a47",
      "name": "Record ID Ã© Igual?"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=http://host.docker.internal:85/api/database/rows/table/710/{{ $json.id }}/?user_field_names=true\n\n\n",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "URL VÃ­deo Clip",
              "value": "={{ $json.response }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        540,
        -320
      ],
      "id": "ed3e75ff-19d1-4131-a19d-e4776a85c515",
      "name": "Atualizar URL VÃ­deo Clip"
    },
    {
      "parameters": {
        "url": "http://host.docker.internal:85/api/database/rows/table/314/?user_field_names=true&filter__field_6761__contains=Clipes&filter__field_6749__empty=",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1340,
        20
      ],
      "id": "3a51022f-5a89-4c1e-a736-aa7b22908ca0",
      "name": "Buscar tabelas 4"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=http://host.docker.internal:85/api/database/rows/table/314/{{ $json.results[0].id }}/?user_field_names=true\n\n\n",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "Status",
              "value": "Combine"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1160,
        20
      ],
      "id": "8ba8f78f-4ffd-40b0-b110-9b24d602629a",
      "name": "Atualizar Status 3"
    },
    {
      "parameters": {
        "url": "=http://host.docker.internal:85/api/database/rows/table/710/?user_field_names=true&filter__Record%20ID__equal={{ $json.id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -760,
        20
      ],
      "id": "00f9e84c-218d-48d7-855f-00c6edbb6fc5",
      "name": "Record ID Ã© Igual? (2)"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=http://host.docker.internal:85/api/database/rows/table/314/{{ $json.id }}/?user_field_names=true\n\n\n",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "URL VÃ­deo Bruto",
              "value": "={{ $json.response }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        520,
        20
      ],
      "id": "32bbc9b9-8175-4f59-a52d-ae3f28655f8d",
      "name": "Atualizar URL VÃ­deo Bruto"
    },
    {
      "parameters": {
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "URL VÃ­deo Clip"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        -160,
        20
      ],
      "id": "6460124f-b37d-4cd2-8c66-579ac49dde7b",
      "name": "Aggregate2"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "25c09a32-7ec5-40ac-a648-d1f62d74575e",
              "name": "results",
              "value": "={{ $json.results }}",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -560,
        20
      ],
      "id": "5f5ea4ae-37d1-42e6-835f-13ce91f6c9bf",
      "name": "Separar Results"
    },
    {
      "parameters": {
        "fieldToSplitOut": "results",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -360,
        20
      ],
      "id": "1effcbf4-91b8-4cec-ac9f-7b8a05d17d20",
      "name": "Split Out6"
    },
    {
      "parameters": {
        "url": "http://host.docker.internal:85/api/database/rows/table/314/?user_field_names=true&filter__field_6750__empty=",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1340,
        320
      ],
      "id": "9e762ebe-428f-46d9-a0ad-23978c54d85b",
      "name": "Buscar tabelas 5"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=http://host.docker.internal:85/api/database/rows/table/314/{{ $('Buscar tabelas 5').item.json.results[0].id }}/?user_field_names=true\n\n\n",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "URL VÃ­deo + Audio",
              "value": "={{ $json.response[0].file_url }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -680,
        320
      ],
      "id": "11520adc-b710-4067-b2a5-f9833cb79c9c",
      "name": "Atualizar URL VÃ­deo + Audio"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=http://host.docker.internal:85/api/database/rows/table/314/{{ $('Buscar tabelas 6').item.json.results[0].id }}/?user_field_names=true\n\n\n",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "URL VÃ­deo Legenda",
              "value": "={{ $json.response }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        520,
        320
      ],
      "id": "7f3a1a51-7032-4aad-836a-9b3a0931a312",
      "name": "Atualizar URL VÃ­deo Legenda"
    },
    {
      "parameters": {
        "url": "http://host.docker.internal:85/api/database/rows/table/314/?user_field_names=true&filter__field_6761__contains=Combine&filter__field_6748__empty=",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -300,
        320
      ],
      "id": "8c8a4484-f95e-44e1-a75b-4a11a4148538",
      "name": "Buscar tabelas 6"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=http://host.docker.internal:85/api/database/rows/table/314/{{ $json.results[0].id }}/?user_field_names=true\n\n\n",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Token zR3mwIRhRnlixpCMmTar1ee7WegU1ZGy"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "Status",
              "value": "Legenda"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -20,
        320
      ],
      "id": "f6acdc2f-abef-419c-b246-7f204935b581",
      "name": "Atualizar Status 4"
    },
    {
      "parameters": {
        "functionCode": "const script = $('ID + URL Legenda').item.json.Script;\nconst estilo = $('ID + URL Legenda').item.json.Estilo;\nreturn items.map(item => {\n  item.json.contextLoaded = 'loaded';\n  item.json.script = script;\n  item.json.estilo = estilo;\n  return item;\n});"
      },
      "id": "7a2d8b01-90ad-45ce-b584-5a75044a9c83",
      "name": "Context Loader1",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        -1320,
        -680
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.contextLoaded }}",
              "value2": "loaded"
            }
          ]
        }
      },
      "id": "394182b7-626e-47a6-ad4d-9ac0e8d61fcd",
      "name": "If Context Loaded1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        -1120,
        -680
      ]
    },
    {
      "parameters": {
        "functionCode": "return items.map(item => ({\n  json: {\n    words: item.json.words,\n    id: item.json.id,\n    duration: item.json.duration,\n    script: item.json.script,\n    estilo: item.json.estilo\n  }\n}));"
      },
      "id": "024eae3a-f1bd-4f7c-bfc5-383ee3728bf8",
      "name": "Prepare Scene",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        -800,
        -740
      ]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Use o SCRIPT e o ESTILO previamente carregados.\n\nSCRIPT:\n{{ $json.script }}\n\nESTILO:\n{{ $json.estilo }}\n\nAqui estÃ¡ a cena atual:\nParte do roteiro: {{ $json.words }},safe for work, family-friendly, no nudity, dynamic angle, dramatic lighting, immersive textures, cinematic, pastel tones, bokeh, depth of field\nPosiÃ§Ã£o no script: {{ $json.id }}\n\nGere um prompt de imagem descritivo para esta cena, seguindo o estilo indicado.",
        "hasOutputParser": true,
        "messages": {
          "messageValues": [
            {
              "message": "=You are an image-prompt generator for video scenes. For each script snippet, return:\n\n{\n  \"Prompt\": \"...up to 240 characters...\"\n}\n\nEssential rules\nâ‰¤ 240 characters Â· no text in the image\n\nExplicitly mark: â€œsafe for workâ€, â€œfamily-friendlyâ€, â€œno nudityâ€, â€œno textâ€, â€œno watermarksâ€, â€œno extra limbsâ€\n\nCite the given art style (e.g., Cartoon Flat, Hyper-Realistic, Hand-Drawn)\n\nCreate an impactful image: dynamic composition, dramatic angles, striking lighting, rich textures, environmental storytelling\n\nSmall themes â†’ microuniverse: use lighting, framing, and atmosphere to expand the scene\n\nFocus on depth, detail, and artistic impact; avoid irrelevant complexity\n\nPrompt checklist (include when relevant)\nMain theme\n\nArt style\n\nComposition (close-up, over-the-shoulder, low perspective, etc.)\n\nLighting (backlight, neon, deep shadows, reflections)\n\nMicrouniverse / environmental narrative\n\nDominant color palette\n\nEmotional mood / atmosphere\n\nCamera technique (bokeh, depth of field, contrast, lens distortion)\n\nSubtle extra elements that enrich without clutter\n\nUltra-short examples\nHyper-Realistic: â€œMacro shot of glue drop hanging from cracked porcelain teacup, golden desk-lamp glow, floating dust motes, shallow focus, warm atmosphere.â€\n\nCyberpunk: â€œNeon-soaked alley blue/magenta, hoverbike headlights slice mist, silhouette in metallic trench coat, low angle, bright reflections.â€\n\nFollow these points and keep every prompt short, vivid, and cinematic."
            }
          ]
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.5,
      "position": [
        -580,
        -740
      ],
      "id": "e6cd9ecb-8922-4bc3-95d8-7bc245f952b4",
      "name": "Image Prompter V3 ðŸ“·",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// 1. Coleta todas as palavras da legenda\nconst palavrasOriginais = items.map(i => i.json.word);\n\n// 2. Junta tudo em um Ãºnico array de palavras\nconst palavras = palavrasOriginais.join(' ').split(' ');\n\n// 3. Agrupa em blocos de atÃ© 3 palavras\nconst grupos = [];\nfor (let i = 0; i < palavras.length; i += 3) {\n  grupos.push(palavras.slice(i, i + 3).join(' '));\n}\n\n// 4. Define a duraÃ§Ã£o total com base no Ãºltimo item de Frases Curtas\nconst duracaoTotal = items[items.length - 1].json.end_time || 10;\nconst duracaoPorGrupo = duracaoTotal / grupos.length;\n\n// 5. Gera os objetos com text, start e end\nreturn grupos.map((texto, i) => {\n  return {\n    json: {\n      text: texto,\n      start: +(i * duracaoPorGrupo).toFixed(3),\n      end: +((i + 1) * duracaoPorGrupo).toFixed(3)\n    }\n  };\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -180,
        -1240
      ],
      "id": "0b0df086-2072-4c51-b191-093d9200c4b2",
      "name": "3 Palavras/Linha"
    }
  ],
  "connections": {
    "Set Idea": {
      "main": [
        [
          {
            "node": "Provedor Image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "On form submission": {
      "main": [
        [
          {
            "node": "Set Idea",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "Output Parser ðŸ› ",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Script Writier ðŸ§ ": {
      "main": [
        [
          {
            "node": "Output Parser ðŸ› ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Output Parser ðŸ› ": {
      "main": [
        [
          {
            "node": "Combine",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Long form to Script Writier ðŸ§ ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Script Writier ðŸ§ ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Long form to Script Writier ðŸ§ ": {
      "main": [
        [
          {
            "node": "Output Parser ðŸ› ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Combine": {
      "main": [
        [
          {
            "node": "Format Cleanup",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Cleanup": {
      "main": [
        [
          {
            "node": "Criar tabelas baserow 1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload captions To Baserow": {
      "main": [
        [
          {
            "node": "Atualizar URL Legenda",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload tts to baserow": {
      "main": [
        [
          {
            "node": "Atualizar Tabela TTS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate TTS": {
      "main": [
        [
          {
            "node": "Upload tts to baserow",
            "type": "main",
            "index": 0
          },
          {
            "node": "Criar Legenda",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Criar Legenda": {
      "main": [
        [
          {
            "node": "Frases Curtas",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Frases Curtas": {
      "main": [
        [
          {
            "node": "3 Palavras/Linha",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Legenda.json": {
      "main": [
        [
          {
            "node": "Upload captions To Baserow",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate3": {
      "main": [
        [
          {
            "node": "IDs To Array1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IDs To Array1": {
      "main": [
        [
          {
            "node": "Atualizar IDs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser2": {
      "ai_outputParser": [
        [
          {
            "node": "Image Prompter V3 ðŸ“·",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Split into 5s Scenes": {
      "main": [
        [
          {
            "node": "Fixer",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Segment File": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fixer": {
      "main": [
        [
          {
            "node": "Context Loader1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "Split into 5s Scenes",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch - Image Provider": {
      "main": [
        [],
        [
          {
            "node": "HTTP - Together.ai",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP - Together.ai": {
      "main": [
        [
          {
            "node": "Base64 To String",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP - Upload To Baserow": {
      "main": [
        [
          {
            "node": "Atualizar Tabela Imagem",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert String to binary": {
      "main": [
        [
          {
            "node": "HTTP - Upload To Baserow",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Base64 To String": {
      "main": [
        [
          {
            "node": "Convert String to binary",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait1": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "Buscar tabelas 3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch - Image Provider",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out2": {
      "main": [
        [
          {
            "node": "Record ID Ã© Igual?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Captions": {
      "main": [
        [
          {
            "node": "Atualizar URL VÃ­deo Legenda",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out1": {
      "main": [
        [
          {
            "node": "Record ID Ã© Igual? (2)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Combine Clips3": {
      "main": [
        [
          {
            "node": "Atualizar URL VÃ­deo + Audio",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Video url to array": {
      "main": [
        [
          {
            "node": "Combine Clips",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items3": {
      "main": [
        [
          {
            "node": "Buscar tabelas 4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Create Clips",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Combine Clips": {
      "main": [
        [
          {
            "node": "Atualizar URL VÃ­deo Bruto",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Clips": {
      "main": [
        [
          {
            "node": "Atualizar URL VÃ­deo Clip",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Output Parser ðŸ› ",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "Script Writier ðŸ§ ",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "Long form to Script Writier ðŸ§ ",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Image Prompter V3 ðŸ“·",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Provedor Image": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Criar tabelas baserow 1": {
      "main": [
        [
          {
            "node": "Buscar tabelas 1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Buscar tabelas 1": {
      "main": [
        [
          {
            "node": "ID Tabela",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ID Tabela": {
      "main": [
        [
          {
            "node": "Generate TTS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Buscar tabelas 2": {
      "main": [
        [
          {
            "node": "ID + URL Legenda",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ID + URL Legenda": {
      "main": [
        [
          {
            "node": "Switch - Image Provider1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualizar Status 1": {
      "main": [
        [
          {
            "node": "Get Segment File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Criar tabelas baserow (Cenas)": {
      "main": [
        [
          {
            "node": "Aggregate3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualizar Tabela TTS": {
      "main": [
        [
          {
            "node": "Buscar tabelas 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Buscar Cenas": {
      "main": [
        [
          {
            "node": "Split Out3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualizar Tabela Imagem": {
      "main": [
        [
          {
            "node": "Wait1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ID Provedor Imagem 2": {
      "main": [
        [
          {
            "node": "Renomear",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch - Image Provider1": {
      "main": [
        [],
        [
          {
            "node": "ID Provedor Imagem 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Renomear": {
      "main": [
        [
          {
            "node": "Atualizar Status 1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out3": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Buscar tabelas 3": {
      "main": [
        [
          {
            "node": "Atualizar Status 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualizar Status 2": {
      "main": [
        [
          {
            "node": "Split Out2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Record ID Ã© Igual?": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualizar URL VÃ­deo Clip": {
      "main": [
        [
          {
            "node": "Loop Over Items3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Buscar tabelas 4": {
      "main": [
        [
          {
            "node": "Atualizar Status 3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualizar Status 3": {
      "main": [
        [
          {
            "node": "Split Out1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Record ID Ã© Igual? (2)": {
      "main": [
        [
          {
            "node": "Separar Results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate2": {
      "main": [
        [
          {
            "node": "Video url to array",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Separar Results": {
      "main": [
        [
          {
            "node": "Split Out6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out6": {
      "main": [
        [
          {
            "node": "Aggregate2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Buscar tabelas 5": {
      "main": [
        [
          {
            "node": "Combine Clips3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualizar URL VÃ­deo Bruto": {
      "main": [
        [
          {
            "node": "Buscar tabelas 5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Buscar tabelas 6": {
      "main": [
        [
          {
            "node": "Atualizar Status 4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualizar Status 4": {
      "main": [
        [
          {
            "node": "Create Captions",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Atualizar URL VÃ­deo + Audio": {
      "main": [
        [
          {
            "node": "Buscar tabelas 6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Context Loader1": {
      "main": [
        [
          {
            "node": "If Context Loaded1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If Context Loaded1": {
      "main": [
        [
          {
            "node": "Prepare Scene",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Scene": {
      "main": [
        [
          {
            "node": "Image Prompter V3 ðŸ“·",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Image Prompter V3 ðŸ“·": {
      "main": [
        [
          {
            "node": "Criar tabelas baserow (Cenas)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "3 Palavras/Linha": {
      "main": [
        [
          {
            "node": "Legenda.json",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": null,
  "pinData": {},
  "versionId": "70d38fa7-ddaa-4040-8c6f-493526ae13ac",
  "triggerCount": 0,
  "tags": []
}